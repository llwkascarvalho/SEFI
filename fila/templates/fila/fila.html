{% extends 'core/base.html' %}
{% load static %}
{% load auth_extras %}
{% block content %}
{% block css %}
<link rel="stylesheet" href="{% static 'fila/css/fila.css' %}">
{% endblock %}

{% if request.user.is_superuser %}
    <div class="fila">
        <div class="text-filter">
            <div class="text">
                <h1>Fila de Impressão</h1>
                <p>Essas são as solicitações que você precisa concluir!</p>
            </div>
            <div class="filter">
                <p>Filtrar</p>
                <img src="{% static 'core/icones/filtro.svg' %}" alt="filtro">
            </div>
        </div>
        
        <div class="filter-list">
            <div class="filter-list-status">
                <p>STATUS:</p>
                <div class="filter-list-status-options">
                    <div class="filter-list-status-option">
                        <p>Na fila</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                    <div class="filter-list-status-option">
                        <p>Em andamento</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                    <div class="filter-list-status-option">
                        <p>Aguardando retirada</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                </div>
            </div>
            <hr class="filter-list-divider">
            <div class="filter-list-type">
                <p>TIPO:</p>
                <div class="filter-list-type-options">
                    <div class="filter-list-type-option">
                        <p>Exercício</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                    <div class="filter-list-type-option">
                        <p>Prova</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                </div>
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Título</th>
                    <th>Status</th>
                    <th>Professor</th>
                    <th>Quantidade de Cópias</th>
                    <th>Tipo de atividade</th>
                    <th>Grampos</th>
                    <th>Data de Solicitação</th>
                    <th>Data de Entrega</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% if solicitacoes %}
                    {% for solicitacao in solicitacoes %}
                    <tr>
                        <td>{{ solicitacao.id }}</td>
                        <td>{{ solicitacao.titulo }}</td>
                        <td class="status-{{ solicitacao.status|slugify }}">{{ solicitacao.status }}</td>
                        <td>{{ solicitacao.usuario.first_name }} {{ solicitacao.usuario.last_name }}</td>
                        <td>{{ solicitacao.quantidade_copias }}</td>
                        <td>{{ solicitacao.tipo_atividade }}</td>
                        <td>{% if solicitacao.grampos %}Sim{% else %}Não{% endif %}</td>
                        <td>{{ solicitacao.data_solicitacao|date:"d \d\e M." }}</td>
                        <td>{{ solicitacao.data_entrega|date:"d \d\e M." }}</td>
                        <td>
                            <a href="{% url 'detalhes' solicitacao.id %}"><button>Detalhes</button></a>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr class="empty-state">
                        <td colspan="10">
                            <div class="empty-state-content">
                                <p>Nenhuma solicitação encontrada</p>
                            </div>
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
        <div id="quantidade-solicitacoes">
            {% if solicitacoes %}
                <p>Mostrando <strong>{{ solicitacoes.count }}</strong> 
                    {% if solicitacoes.count == 1 %}solicitação{% else %}solicitações{% endif %}</p>
            {% endif %}
        </div>
    </div>
{% endif %}


{% if request.user|has_group:"Professor" %}
    <div class="fila">
        <div class="text-filter">
            <div class="text">
                <h1>Fila de Impressão</h1>
                <p>Essas são as impressões feitas por você!</p>
            </div>
            <div class="filter">
                <p>Filtrar</p>
                <img src="{% static 'core/icones/filtro.svg' %}" alt="filtro">
            </div>
        </div>

        <div class="filter-list">
            <div class="filter-list-status">
                <p>STATUS:</p>
                <div class="filter-list-status-options">
                    <div class="filter-list-status-option">
                        <p>Na fila</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                    <div class="filter-list-status-option">
                        <p>Em andamento</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                    <div class="filter-list-status-option">
                        <p>Aguardando retirada</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                </div>
            </div>
            <hr class="filter-list-divider">
            <div class="filter-list-type">
                <p>TIPO:</p>
                <div class="filter-list-type-options">
                    <div class="filter-list-type-option">
                        <p>Exercício</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                    <div class="filter-list-type-option">
                        <p>Prova</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                </div>
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Título</th>
                    <th>Status</th>
                    <th>Quantidade de Cópias</th>
                    <th>Tipo de atividade</th>
                    <th>Grampos</th>
                    <th>Data de Solicitação</th>
                    <th>Data de Entrega</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% if solicitacoes %}
                    {% for solicitacao in solicitacoes %}
                    <tr>
                        <td>{{ solicitacao.id }}</td>
                        <td>{{ solicitacao.titulo }}</td>
                        <td class="status-{{ solicitacao.status|slugify }}">{{ solicitacao.status }}</td>
                        <td>{{ solicitacao.quantidade_copias }}</td>
                        <td>{{ solicitacao.tipo_atividade }}</td>
                        <td>{% if solicitacao.grampos %}Sim{% else %}Não{% endif %}</td>
                        <td>{{ solicitacao.data_solicitacao|date:"d \d\e M." }}</td>
                        <td>{{ solicitacao.data_entrega|date:"d \d\e M." }}</td>
                        <td>
                            <a href="{% url 'detalhes' solicitacao.id %}"><button>Detalhes</button></a>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr class="empty-state">
                        <td colspan="9">
                            <div class="empty-state-content">
                                <p>Nenhuma solicitação encontrada</p>
                            </div>
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
        <div id="quantidade-solicitacoes">
            {% if solicitacoes %}
                <p>Mostrando <strong>{{ solicitacoes.count }}</strong> 
                    {% if solicitacoes.count == 1 %}solicitação{% else %}solicitações{% endif %}</p>
            {% endif %}
        </div>
    </div>
{% endif %}

{% if request.user|has_group:"Bolsista" %}
    <div class="fila">
        <div class="text-filter">
            <div class="text">
                <h1>Fila de Impressão</h1>
                <p>Essas são as solicitações que precisam ser entregues!</p>
            </div>
            <div class="filter">
                <p>Filtrar</p>
                <img src="{% static 'core/icones/filtro.svg' %}" alt="filtro">
            </div>
        </div>

                <div class="filter-list">
            <div class="filter-list-status">
                <p>STATUS:</p>
                <div class="filter-list-status-options">
                    <div class="filter-list-status-option">
                        <p>Na fila</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                    <div class="filter-list-status-option">
                        <p>Em andamento</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                    <div class="filter-list-status-option">
                        <p>Aguardando retirada</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                </div>
            </div>
            <hr class="filter-list-divider">
            <div class="filter-list-type">
                <p>TIPO:</p>
                <div class="filter-list-type-options">
                    <div class="filter-list-type-option">
                        <p>Exercício</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                    <div class="filter-list-type-option">
                        <p>Prova</p>
                        <input type="checkbox" name="status" id="status">
                    </div>
                </div>
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Título</th>
                    <th>Status</th>
                    <th>Professor</th>
                    <th>Quantidade de Cópias</th>
                    <th>Tipo de atividade</th>
                    <th>Grampos</th>
                    <th>Data de Solicitação</th>
                    <th>Data de Entrega</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% if solicitacoes %}
                    {% for solicitacao in solicitacoes %}
                    <tr>
                        <td>{{ solicitacao.id }}</td>
                        <td>{{ solicitacao.titulo }}</td>
                        <td class="status-{{ solicitacao.status|slugify }}">{{ solicitacao.status }}</td>
                        <td>{{ solicitacao.usuario.first_name }} {{ solicitacao.usuario.last_name }}</td>
                        <td>{{ solicitacao.quantidade_copias }}</td>
                        <td>{{ solicitacao.tipo_atividade }}</td>
                        <td>{% if solicitacao.grampos %}Sim{% else %}Não{% endif %}</td>
                        <td>{{ solicitacao.data_solicitacao|date:"d \d\e\ M." }}</td>
                        <td>{{ solicitacao.data_entrega|date:"d \d\e\ M." }}</td>
                        <td>
                            <a href="{% url 'detalhes' solicitacao.id %}"><button>Detalhes</button></a>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr class="empty-state">
                        <td colspan="10">
                            <div class="empty-state-content">
                                <p>Nenhuma solicitação encontrada</p>
                            </div>
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
        <div id="quantidade-solicitacoes">
            {% if solicitacoes %}
                <p>Mostrando <strong>{{ solicitacoes.count }}</strong> 
                    {% if solicitacoes.count == 1 %}solicitação{% else %}solicitações{% endif %}</p>
            {% endif %}
        </div>
    </div>
{% endif %}

<script src="{% static 'fila/js/dropdown-filtro.js' %}"></script>

{% endblock %}